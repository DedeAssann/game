# importing the necessary modules

#: import Screen kivy.uix.screenmanager
#: import AnchorLayout kivy.uix.anchorlayout
#: import PageLayout kivy.uix.pagelayout

#: import menu menu
##: import user_controls user_controls

# defining the different needed variables
#: import score main_widget
#: set menu_title "G  A  L  A  X  Y"
#: set home_button_title "P  L  A  Y"
#: set pause_widget_title " R  E  S  U  M  E "
#: set settings_button_title "S  E  T  T  I  N  G  S"
#: set return_settings_button_title "H  O  M  E"
#: set _bw dp(3)
##: set score MainWidget.score
#: set best_score MainWidget.best_score

# The manager of the screen

WindowManager:
    game_window: game_window
    home_window: home_window
    settings_window: settings_window
    HomeWindow:
        id: home_window
    GameWindow:
        id: game_window
    SettingsWindow:
        id:settings_window


# Window manager

<WindowManager>:

# defining the Screens

# the game window

<GameWindow>:
    name: "game_screen"
    main_widget: main_widget
    home_button: home_button
    MainWidget:
        id: main_widget
    HomeButton:
        id: home_button
        on_press:
            app.root.current = "home_screen"


# home window

<HomeWindow>:
    name: "home_screen"
    canvas:
        Rectangle:
            size: self.size
            source: "bg1.jpg"
    ExitButton:
        id: exit_button
        on_release: root.exit()
    Label:
        font_size: dp(60)
        font_name: "fonts/Sackers-Gothic-Std-Light.ttf"
        text: menu_title
        pos_hint: {"center_x": .5, "center_y": .6}
    Button:
        canvas.before:
            Color:
                rgba: .2, .7, 1, .25
            Line:
                width: dp(2)
                rectangle: self.x, self.y, self.width, self.height
        font_size: dp(25)
        font_name: "fonts/Eurostile.ttf"
        text: home_button_title
        pos_hint: { "center_x": .5, "center_y": .3}
        size_hint: .2, .1
        on_press:
            app.root.current = "game_screen"
        background_color: .8, .5, 1, .2
    Button:
        canvas.before:
            Color:
                rgba: .2, .7, 1, .25
            Line:
                width: dp(2)
                rectangle: self.x, self.y, self.width, self.height
        font_size: dp(25)
        font_name: "fonts/Eurostile.ttf"
        text: settings_button_title
        pos_hint: { "right": 1, "top": 1}
        size_hint: .18, .08
        on_press: 
            app.root.current = "settings_screen"
            #app.main_widget.pause_widget.opacity = 0
        background_color: .8, .5, 1, .2

# settins window

<SettingsWindow@Screen>:
    name: "settings_screen"
    canvas:
        Rectangle:
            size: self.size
            source: "bg1.jpg"
    Label:
        text: "S E T T I N G S"
        font_name: "fonts/Lcd.ttf"
        font_size: dp(180)
        pos_hint: {"center_x": .5, "top": 1}
        color: 1, 1, 1, .15
    AnchorLayout:
        anchor_x: "left"
        anchor_y: "top"
        size_hint: 1, .6
        pos_hint: {"center_x": .5, "top": 1}
        canvas.before:
            Color:
                rgba: 0.2, 1, 1, .3
            Line:
                width: dp(2.5)
                rectangle: self.x, self.y, self.width, self.height
        PageLayoutExample:
    Button:
        canvas.before:
            Color:
                rgba: .2, .7, 1, .25
            Line:
                width: dp(2)
                rectangle: self.x, self.y, self.width, self.height
        font_size: dp(25)
        font_name: "fonts/Sackers-Gothic-Std-Light.ttf"
        text: return_settings_button_title
        pos_hint: { "right": .18, "top": .99}
        size_hint: .18, .08
        on_press:
            app.root.current = "home_screen"
        background_color: .8, .5, 1, .2              
    BoxLayout:
        orientation: 'vertical'
        size_hint: 1, .40
        #RelativeLayout:
        #    pos_hint: {'right': 1, 'top': 1}
        #    size_hint: 1, .45
        GridLayout:
            rows:2
            cols:4
            spacing: dp(20)
            Button_1:                                                                                                
            Button_2:                                                                                                
            Button_3:                                                                                                                                
            Button_4:                                                                                                                                
            Button_5:                
            Button_6:                                                                                                
            Button_7:                                                                                                                                
            Button_8:                                                                                                                                


# the game widget

<PageLayoutExample>:
    canvas.before:
        Color:
            rgba: 0, 0, 0, .47
        Rectangle:
            size: self.size
            pos: self.pos
    size_hint: 1, 1
    pos_hint: {"center_x": .5, "top": 1}
    score_widget: score_widget
    ScoreWidget:
        id: score_widget

# the score widget
<ScoreWidget@RelativeLayout>:
    canvas.before:    
        Color:
            rgba: 0, 0, 0, .5
        Rectangle:
            size: self.size
    score: score
    best_score: best_score
    Label:
        text: " S  C  O  R  E " # + str(root.score)
        font_name: "fonts/Eurostile.ttf"
        font_size: dp(40)
        pos_hint: {"center_x": .5, "top": 1}
        size_hint: 1, .5

<MainWidget>:
    canvas.before:
        Rectangle:
            size: self.size
            source: "bg1.jpg"
    menu_widget: menu_widget
    pause_widget: pause_widget
    pause_button: pause_button
    perspective_point_x: self.width/2
    perspective_point_y: self.height*0.75
    PauseWidget:
        id: pause_widget
    PauseButton:
        id: pause_button
        text: root.pause_button_txt
        on_press:
            root.on_pause_button_pressed()
    MenuWidget:
        id: menu_widget
    Label:
        id: score
        text: root.score_txt
        font_size: dp(32)
        font_name: "fonts/Lcd.ttf"
        size_hint: .2, .2
        pos_hint: {"x": 0, "top": 1}


# the pause widget

<PauseWidget>:
    canvas.before:
        Color:
            rgba: 0, 0, 0, .8
        Rectangle:
            size: self.size
    Label:
        font_size: dp(90)
        font_name: "fonts/Sackers-Gothic-Std-Light.ttf"
        text: pause_widget_title
        pos_hint: {"center_x": 0.5, "center_y": .75}

# The Home Button

<HomeButton>:
    canvas.before:
        Color:
            rgba: .2, .7, 1, .25
        Line:
            width: dp(2)
            rectangle: self.x, self.y, self.width, self.height
    font_size: dp(30)
    font_name: "fonts/Eurostile.ttf"
    text: return_settings_button_title
    pos_hint: { "right": 1, "top": 1}
    size_hint: .18, .08
    background_color: .8, .5, 1, .08


# The Exit button

<ExitButton@Button>:
    canvas.before:
        Color:
            rgba: .2, .7, 1, .25
        Line:
            width: dp(2)
            rectangle: self.x, self.y, self.width, self.height
    font_size: dp(30)
    font_name: "fonts/Eurostile.ttf"
    text: "E X I T"
    pos_hint: { "right": .18, "top": 1}
    size_hint: .18, .08
    background_color: .8, .5, 1, .08


# The Pause Button

<PauseButton>:
    id: pause_button
    canvas.before:
        Color:
            rgba: .2, .7, 1, .25
        Line:
            width: dp(2)
            rectangle: self.x, self.y, self.width, self.height
    font_name: "fonts/Eurostile.ttf"
    font_size: dp(30)
    pos_hint: {"right": .18, "top": 1}
    size_hint: .18, .08
    background_color: .8, .5, 1, .08
    disabled: True

# Creation of all the settings page buttons
# Managing all the buttons on the settings page

# first button

<Button_1@Button>:
    canvas.before:
        Color:
            rgba: .2, .7, 1, .5
        Line:
            width: _bw
            rectangle: self.x, self.y, self.width, self.height
    font_size: dp(20)
    font_name: "fonts/Eurostile.ttf"
    text: "S C O R E"
    pos_hint: { "right": 1, "top": 1}
    size_hint: .15, .06
    on_press: 
        #app.root.current = "settings_screen"
    background_color: .8, .5, 1, .2

# second button

<Button_2@Button>:
    canvas.before:
        Color:
            rgba: .2, .7, 1, .5
        Line:
            width: _bw
            rectangle: self.x, self.y, self.width, self.height
    font_size: dp(20)
    font_name: "fonts/Eurostile.ttf"
    text: "Button 2"
    pos_hint: { "right": 1, "top": 1}
    size_hint: .15, .06
    on_press: 
        #app.root.current = "settings_screen"
    background_color: .8, .5, 1, .2

# third button

<Button_3@Button>:
    canvas.before:
        Color:
            rgba: .2, .7, 1, .5
        Line:
            width: _bw
            rectangle: self.x, self.y, self.width, self.height
    font_size: dp(20)
    font_name: "fonts/Eurostile.ttf"
    text: "Button 3"
    pos_hint: { "right": 1, "top": 1}
    size_hint: .15, .06
    on_press: 
        #app.root.current = "settings_screen"
    background_color: .8, .5, 1, .2

# fourth button

<Button_4@Button>:
    canvas.before:
        Color:
            rgba: .2, .7, 1, .5
        Line:
            width: _bw
            rectangle: self.x, self.y, self.width, self.height
    font_size: dp(20)
    font_name: "fonts/Eurostile.ttf"
    text: "Button 4"
    pos_hint: { "right": 1, "top": 1}
    size_hint: .15, .06
    on_press: 
        #app.root.current = "settings_screen"
    background_color: .8, .5, 1, .2

# fifth button

<Button_5@Button>:
    canvas.before:
        Color:
            rgba: .2, .7, 1, .5
        Line:
            width: _bw
            rectangle: self.x, self.y, self.width, self.height
    font_size: dp(20)
    font_name: "fonts/Eurostile.ttf"
    text: "Button 5"
    pos_hint: { "right": 1, "top": 1}
    size_hint: .15, .06
    on_press: 
        #app.root.current = "settings_screen"
    background_color: .8, .5, 1, .2

# sixth button

<Button_6@Button>:
    canvas.before:
        Color:
            rgba: .2, .7, 1, .5
        Line:
            width: _bw
            rectangle: self.x, self.y, self.width, self.height
    font_size: dp(20)
    font_name: "fonts/Eurostile.ttf"
    text: "Button 6"
    pos_hint: { "right": 1, "top": 1}
    size_hint: .15, .06
    on_press: 
        #app.root.current = "settings_screen"
    background_color: .8, .5, 1, .2

# seventh button

<Button_7@Button>:
    canvas.before:
        Color:
            rgba: .2, .7, 1, .5
        Line:
            width: _bw
            rectangle: self.x, self.y, self.width, self.height
    font_size: dp(20)
    font_name: "fonts/Eurostile.ttf"
    text: "Button 7"
    pos_hint: { "right": 1, "top": 1}
    size_hint: .15, .06
    on_press: 
        #app.root.current = "settings_screen"
    background_color: .8, .5, 1, .2

# eighth button

<Button_8@Button>:
    canvas.before:
        Color:
            rgba: .2, .7, 1, .5
        Line:
            width: _bw
            rectangle: self.x, self.y, self.width, self.height
    font_size: dp(20)
    font_name: "fonts/Eurostile.ttf"
    text: "Button 8"
    pos_hint: { "right": 1, "top": 1}
    size_hint: .15, .06
    on_press: 
        #app.root.current = "settings_screen"
    background_color: .8, .5, 1, .2


# ...

# So for now, I have to create many widgets to add to the page layout
# And then I'll link the functionnality in them to the game components and controls
# So we'll have a complete settings page
# 

# Let's work!
